function _array_like_to_array(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function _array_with_holes(e){if(Array.isArray(e))return e}function _array_without_holes(e){if(Array.isArray(e))return _array_like_to_array(e)}function _define_property(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _iterable_to_array(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _iterable_to_array_limit(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,o,i=[],a=!0,s=!1;try{for(t=t.call(e);!(a=(n=t.next()).done)&&(i.push(n.value),!r||i.length!==r);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==t.return||t.return()}finally{if(s)throw o}}return i}}function _non_iterable_rest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _non_iterable_spread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _object_spread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){_define_property(e,r,t[r])}))}return e}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function _object_spread_props(e,r){return r=null!=r?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})),e}function _sliced_to_array(e,r){return _array_with_holes(e)||_iterable_to_array_limit(e,r)||_unsupported_iterable_to_array(e,r)||_non_iterable_rest()}function _to_consumable_array(e){return _array_without_holes(e)||_iterable_to_array(e)||_unsupported_iterable_to_array(e)||_non_iterable_spread()}function _unsupported_iterable_to_array(e,r){if(e){if("string"==typeof e)return _array_like_to_array(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_array_like_to_array(e,r):void 0}}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7635],{96815:function(e,r,t){"use strict";t.d(r,{z:function(){return o}});var n=t(79614);function o(e,r){return n.He.post("/api_v1.0/store-file",e,{timeout:0,processData:!1,contentType:!1,signal:null==r?void 0:r.signal})}},32203:function(e,r,t){"use strict";t.d(r,{OW:function(){return m},xL:function(){return O},f4:function(){return L},cc:function(){return S},oR:function(){return k},$G:function(){return w},XT:function(){return j},rv:function(){return C},pW:function(){return x},Ly:function(){return I},c:function(){return P},Bi:function(){return M},yV:function(){return D},cC:function(){return E},DU:function(){return N},uU:function(){return y}});var n=t(27434),o=t(17902),i=t(96815),a=t(59403),s=t(36492),u=t(85945),l=t(5164),c=t(79614);function d(e){var r=e.data;return c.Hn.post("/api_v3.0/reels/",r)}function _(e){var r=e.reelId,t=e.like;return c.Hn.post("/api_v3.0/reels/".concat(r,"/like"),{like:t})}function p(e){return c.Hn.post("/api_v3.0/reels/".concat(e,"/seen"))}function f(e){return c.Hn.delete("/api_v3.0/reels/".concat(e))}var v="owner-reels",g="user-reels",h="hashtag-reels",b="top-reels",m=function(){return(0,o.Db)(["add-reel"],d)},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,o.Db)((function(e){var r=e.data,t=e.controller;return(0,i.z)(r,t)}),e)},j=function(e){var r=e.limit,t=e.options,n=void 0===t?{}:t,o=e.userId,i=void 0===o?null:o,s=e.enabled,u=void 0!==s&&s,d=e.isConfirmed,_=void 0===d||d;return(0,a.N)(_object_spread({enabled:!!u,select:function(e){return function(e){return _object_spread_props(_object_spread({},e),{pages:e.pages.map((function(e){return _object_spread_props(_object_spread({},e),{reels:e.reels.map((function(r){var t;return _object_spread_props(_object_spread({},r),{isFrom:"tab",user:e.user,instance:"reel",seen:r.seenCount,like:r.likeCount,link:null!==(t=r.metadata.link)&&void 0!==t?t:null})}))})}))})}(e)},queryKey:["reels"].concat(_to_consumable_array(i?[g,i]:[v,_])),getNextPageParam:function(e){return e.lastIdx>0?e.lastIdx:void 0},queryFn:function(e){var t=e.pageParam;return function(e,r){var t=e.params;return c.Hn.get("/api_v3.0/reels/".concat(r?"user/".concat(r):"my-reels"),{params:(0,l.snakize)(t)})}({params:{limit:r,isConfirmed:_,lastIdx:void 0===t?0:t}},i)}},n))},w=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.a)(_object_spread({queryFn:function(){return c.Hn.get("/api_v3.0/reels/data/".concat(e))},queryKey:["reels","single-reels",e],select:function(e){return function(e){var r,t;return _object_spread_props(_object_spread({},e),{isFrom:"share",instance:"reel",seen:e.seenCount,like:e.likeCount,link:null!==(t=null===(r=e.metadata)||void 0===r?void 0:r.link)&&void 0!==t?t:null})}(e)}},r))},k=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.N)(_object_spread({queryKey:["reels",h,e],select:function(e){return function(e){return _object_spread_props(_object_spread({},e),{pages:e.pages.map((function(e){return _object_spread_props(_object_spread({},e),{reels:e.reels.map((function(e){var r;return _object_spread_props(_object_spread({},e),{instance:"reel",seen:e.seenCount,like:e.likeCount,isFrom:"discovery-hashtag",link:null!==(r=e.metadata.link)&&void 0!==r?r:null})}))})}))})}(e)},queryFn:function(r){var t=r.pageParam,n=void 0===t?0:t;return c.Hn.get("/api_v3.0/hashtag/reels",{params:{hashtag:e,last_id:n}})},getNextPageParam:function(e){return e.lastId>0?e.lastId:void 0}},r))},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.N)(_object_spread({queryFn:function(){return c.Hn.get("/api_v3.0/reels/top",{})},queryKey:["reels",b],select:function(e){return function(e){return _object_spread_props(_object_spread({},e),{pages:e.pages.map((function(e){return e.map((function(e){var r,t;return{reel:_object_spread_props(_object_spread({},e),{instance:"reel",seen:e.seenCount,like:e.likeCount,isFrom:"discovery-top",link:null!==(t=null===(r=e.metadata)||void 0===r?void 0:r.link)&&void 0!==t?t:null})}}))}))})}(e)}},e))},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,o.Db)(p,e)},x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,o.Db)(_,e)},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,o.Db)(f,e)},N=function(e){var r=(0,u.NL)();return(0,n.useCallback)((function(t,n){r.setQueryData(["reels"].concat(_to_consumable_array(e?[v,!0]:[g])),(function(e){return _object_spread_props(_object_spread({},e),{pages:e.pages.map((function(e){return _object_spread_props(_object_spread({},e),{reels:e.reels.map((function(e){return(null==e?void 0:e.id)===t?_object_spread({},e,n):e}))})}))})}))}),[r,e])},P=function(){var e=(0,u.NL)();return(0,n.useCallback)((function(r,t){e.setQueryData(["reels",v,!0],(function(e){return _object_spread_props(_object_spread({},e),{pages:e.pages.map((function(e){return _object_spread_props(_object_spread({},e),{metadata:_object_spread_props(_object_spread({},e.metadata),{countChecking:e.metadata.countChecking-1})})}))})}))}),[e])},S=function(){var e=(0,u.NL)();return(0,n.useCallback)((function(r,t){e.setQueryData(["reels",v,!0],(function(e){return _object_spread_props(_object_spread({},e),{pages:e.pages.map((function(e){return _object_spread_props(_object_spread({},e),{reels:e.reels.filter((function(e){return(null==e?void 0:e.id)!==r})),metadata:_object_spread_props(_object_spread({},e.metadata),{countConfirmed:e.metadata.countConfirmed-1})})}))})}))}),[e])},L=function(){var e=(0,u.NL)();return(0,n.useCallback)((function(r,t){e.setQueryData(["reels",v,!1],(function(e){return _object_spread_props(_object_spread({},e),{pages:e.pages.map((function(e){return _object_spread_props(_object_spread({},e),{reels:e.reels.filter((function(e){return(null==e?void 0:e.id)!==r})),metadata:_object_spread_props(_object_spread({},e.metadata),{countChecking:e.metadata.countChecking-1})})}))})}))}),[e])},D=function(){var e=(0,u.NL)();return(0,n.useCallback)((function(r,t){e.setQueryData(["mixed-page-discovery"],(function(e){return _object_spread_props(_object_spread({},e),{pages:e.pages.map((function(e){return _object_spread_props(_object_spread({},e),{components:e.components.map((function(e){var n;return"reel"===(null==e?void 0:e.type)?_object_spread_props(_object_spread({},e),{reel:(null===(n=e.reel)||void 0===n?void 0:n.id)===r?_object_spread({},e.reel,t):e.reel}):e}))})}))})}))}),[e])},M=function(e){var r=(0,u.NL)();return(0,n.useCallback)((function(t,n){r.setQueryData(["reels",h,e],(function(e){return _object_spread_props(_object_spread({},e),{pages:e.pages.map((function(e){return _object_spread_props(_object_spread({},e),{reels:e.reels.map((function(e){return(null==e?void 0:e.id)===t?_object_spread({},e,n):e}))})}))})}))}),[r,e])},E=function(){var e=(0,u.NL)();return(0,n.useCallback)((function(r,t){e.setQueryData(["reels",b],(function(e){return _object_spread_props(_object_spread({},e),{pages:e.pages.map((function(e){return e.map((function(e){return(null==e?void 0:e.id)===r?_object_spread({},e,t):e}))}))})}))}),[e])}},33656:function(e,r,t){"use strict";t.d(r,{O:function(){return l}});var n=t(27434),o=t(32203),i=t(88592),a=t(39029),s=t(88107),u=t(60802);function l(e){var r,t,l=(0,s.Z)(),c=(0,i.M_)(["userId"]).userId,d=(0,u.l)().getFeatureValue,_=l.query.vendorIdentifier,p=(0,a.b)(_),f=p.data,v=p.isLoading,g=c===(null==f||null===(r=f.user)||void 0===r?void 0:r.id),h=(0,o.XT)({limit:4,enabled:!(v||!e),userId:g?null:null==f||null===(t=f.user)||void 0===t?void 0:t.id}),b=h.data,m=h.isLoading,y=(0,n.useMemo)((function(){return d("reels_is_visible_in_vendor_home")}),[d]),j=(0,n.useMemo)((function(){return d("reels_can_create")}),[d]),w=(0,n.useMemo)((function(){return d("reels_is_visible_in_discovery")}),[d]),k=(0,n.useMemo)((function(){return d("reels_is_visible_in_search")}),[d]),C=(0,n.useMemo)((function(){var r,t,n=null==b||null===(t=b.pages)||void 0===t||null===(r=t[0])||void 0===r?void 0:r.metadata;if(!e||!n)return{reelsChekingCount:0,showReelsInTab:!1,reelsConfirmedCount:0};var o=n.countConfirmed;return{reelsChekingCount:n.countChecking,reelsConfirmedCount:o,showReelsInTab:j&&g||j&&o>0||y&&o>0}}),[e,null==b?void 0:b.pages,j,y,g]),I=C.reelsConfirmedCount,x=C.reelsChekingCount,O=C.showReelsInTab;return{isValidated:!m&&!!b,showReelsInTab:O,canCreateReels:j,showReelsInSearch:j||k,reelsChekingCount:x,canWatchReelsInTab:y,reelsConfirmedCount:I,showReelsInDiscovery:j||w,canWatchReelsInSearch:k,canWatchReelsInDiscovery:w}}},52126:function(e,r,t){"use strict";t.d(r,{Z:function(){return C}});var n=t(32930),o=t(2389),i=t.n(o),a=t(96170),s=t.n(a);function u(e){var r=e.id,t=e.cover,o=e.title,i=e.onClick;return(0,n.jsxs)("div",{className:s().highlight,onClick:function(){i(r)},children:[(0,n.jsx)("div",{className:s()["highlight__image-container"],children:(0,n.jsx)("img",{className:s().highlight__image,src:t.medium,alt:o})}),(0,n.jsx)("div",{className:s().highlight__title,children:o})]})}var l=t(41131),c=t.n(l),d=t(5164),_=t(85945),p=t(45835),f=t(65074),v=t.n(f),g=t(73620),h=t.n(g),b=t(60802),m=t(27434),y=t(89504),j=t(87694),w=i()((function(){return Promise.all([t.e(4296),t.e(2938)]).then(t.bind(t,34296))}),{loadableGenerated:{webpack:function(){return[34296]}},ssr:!1}),k={navigation:{prevEl:".".concat(c().highlights__prev),nextEl:".".concat(c().highlights__next)},breakpoints:{xs:{spaceBetween:12,slidesPerView:4.8},md:{spaceBetween:12,slidesPerView:9.5},lg:{spaceBetween:24,slidesPerView:9.5},xl:{spaceBetween:24,slidesPerView:14.3}}};function C(e){var r=e.vendor,t=_sliced_to_array((0,m.useState)(!1),2),o=t[0],i=t[1],a=_sliced_to_array((0,m.useState)(null),2),s=a[0],l=a[1],f=(0,b.l)().getFeatureValue,g=(0,m.useMemo)((function(){return f("story_fixed_widget")}),[f]),C=(0,y.Cw)(),I=(0,_.NL)(),x=(0,p.b)().ua,O=(0,j.Bp)(r.identifier,g),N=O.isLoading,P=O.data,S=O.fetchNextPage,L=O.hasNextPage,D=O.isFetchingNextPage,M=(0,j.br)(r.identifier),E=(0,m.useMemo)((function(){return null==P?void 0:P.pages.reduce((function(e,r){return e.concat(r.highlights)}),[]).filter((function(e){return e.stories&&e.stories.length>0}))}),[P]),q=(0,m.useMemo)((function(){var e=null==E?void 0:E.find((function(e){return e.id===s}));return void 0===e?null:{stories:e.stories,user:{vendor:r,id:null==r?void 0:r.user.id,name:e.title,avatar:e.cover,hashId:null==r?void 0:r.user.hashId}}}),[r,E,s]);(0,m.useEffect)((function(){C&&C.version===y.gO.MOSTLY_WEBVIEW&&(window.updateHighlights=function(){I.refetchQueries({queryKey:["story",j.sY,r.identifier]}),I.resetQueries({queryKey:["my-stories"]}),I.resetQueries({queryKey:[j.HL,r.id]})})}),[C,I,r.identifier,r.id]),(0,m.useEffect)((function(){D||!L||N||S()}),[D,L,N]);var F=(0,m.useCallback)((function(){i(!1)}),[]),T=(0,m.useCallback)((function(e){var t;C&&C.version===y.gO.MOSTLY_WEBVIEW?null===(t=C.onHighLightClick)||void 0===t||t.call(C,JSON.stringify({last_rank:null==P?void 0:P.pages.at(-1).lastRank,highlights:(0,d.snakize)(E.map((function(e){return _object_spread_props(_object_spread({},e),{hash_id:null==r?void 0:r.user.hashId,vendor:{id:r.id,title:r.title,city:r.city.value,identifier:r.identifier,description:r.description}})})))}),e):(l(e),i(!0))}),[null==P?void 0:P.pages,E,r,C]);return!N&&(null==E?void 0:E.length)>0&&(0,n.jsxs)("div",{className:c().highlights,"data-from":"highlight",children:[o&&(0,n.jsx)(w,{show:!0,data:q,isLoading:N,onClose:F,showVendor:!1,onStoryMutation:M}),!!x.isPc&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:c().highlights__next,children:(0,n.jsx)(v(),{className:c()["highlights__next-button"],color:"secondary",variant:"outline",icon:"bi-angle-left",size:"lg",square:!0})}),(0,n.jsx)("div",{className:c().highlights__prev,children:(0,n.jsx)(v(),{className:c()["highlights__prev-button"],color:"secondary",variant:"outline",icon:"bi-angle-right",size:"lg",square:!0})})]}),(0,n.jsx)(h(),_object_spread_props(_object_spread({otherOptions:{freeMode:!0,mousewheel:{forceToAxis:!0}}},k),{children:null==E?void 0:E.map((function(e){return(0,n.jsx)(h().Item,{children:(0,n.jsx)(u,{id:e.id,title:e.title,cover:e.cover,onClick:T})},e.id)}))}))]})}},45744:function(e,r,t){"use strict";t.d(r,{Z:function(){return f}});var n=t(32930),o=t(2389),i=t.n(o),a=t(5164),s=t(88592),u=t(85945),l=t(60802),c=t(27434),d=t(89504),_=t(87694),p=i()((function(){return Promise.all([t.e(4296),t.e(5587)]).then(t.bind(t,34296))}),{loadableGenerated:{webpack:function(){return[34296]}},ssr:!1});function f(e){var r,t=e.userId,o=e.render,i=(0,l.l)().getFeatureValue,f=(0,c.useMemo)((function(){return i("story_fixed_widget")}),[i]),v=(0,u.NL)(),g=(0,s.M_)(["currentUser"]).currentUser,h=(0,_.Nm)(t,f),b=h.isLoading,m=h.data,y=h.refetch,j=_sliced_to_array((0,c.useState)(!1),2),w=j[0],k=j[1],C=(0,_.uX)(t),I=(0,d.Cw)(),x=(null==m||null===(r=m.stories)||void 0===r?void 0:r.length)>0;(0,c.useEffect)((function(){I&&I.version===d.gO.MOSTLY_WEBVIEW&&(window.updateStories=function(){v.refetchQueries({queryKey:["story",_.HL,t]}),(null==g?void 0:g.id)===t&&(v.refetchQueries({queryKey:["my-stories"]}),(null==g?void 0:g.identifier)&&v.refetchQueries({queryKey:["story",_.sY,null==g?void 0:g.identifier]}))})}),[I,g,t,v]);var O=(0,c.useMemo)((function(){var e;return null==m||null===(e=m.stories)||void 0===e?void 0:e.some((function(e){return!1===e.isSeen}))}),[null==m?void 0:m.stories]),N=(0,c.useMemo)((function(){return m?_object_spread({},m,m.user):null}),[m]),P=(0,c.useCallback)((function(){var e;x&&(I&&I.version===d.gO.MOSTLY_WEBVIEW&&N?null===(e=I.onStoryClick)||void 0===e||e.call(I,JSON.stringify((0,a.snakize)([N])),N.id):k(!0))}),[x,I,N]),S=(0,c.useCallback)((function(){y(),k(!1)}),[y]);return(0,n.jsxs)(n.Fragment,{children:[(0,c.createElement)(o,{openModal:P,storyStatus:b||!x?"none":O?"unseen":"seen"}),w&&(0,n.jsx)(p,{show:!0,data:m,isLoading:b,onClose:S,onStoryMutation:C})]})}},76088:function(e,r,t){"use strict";t.d(r,{Z:function(){return g}});var n=t(32930),o=t(27434),i=t(65074),a=t.n(i),s=t(84581),u=t(88592),l=t(85945),c=t(61262),d=t(17902),_=t(48228),p=t(32066),f=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,d.aM)(["user-following-status",e],(function(){return(0,p.Ru)(e)}),_object_spread({},r))},v=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,_.D)(["follow-unfollow-user"],(function(){return(0,p.Of)(e)}),r)};function g(e){var r=e.buttonProps,t=e.targetUserId,i=e.eventData,d=void 0===i?null:i,_=e.targetUserHashId,p=(0,u.M_)(["isLoggedIn"]).isLoggedIn,g=_sliced_to_array((0,o.useState)(!1),2),h=g[0],b=g[1],m=(0,l.NL)(),y=(0,c.B)().authForm.toggleModal,j=f(t,{enabled:p&&!!t}),w=j.data,k=j.isLoading,C=v({enabled:!!_,targetUserHashid:_,action:h?"unfollow":"follow"}),I=C.mutate,x=C.isLoading;return(0,o.useEffect)((function(){b(null==w?void 0:w.hasFollowed)}),[null==w?void 0:w.hasFollowed]),(0,n.jsx)(a(),_object_spread_props(_object_spread({loading:(k||x)&&p,color:h?"secondary":"primary",variant:h?"outline":"fill",label:h?"دنبال کرده‌اید":"دنبال کنید"},r),{onClick:function(e){e.stopPropagation(),p?(I(),b((function(e){return!e})),setTimeout((function(){m.invalidateQueries(["user-following-status",t],{exact:!0})}),200),d&&"object"==typeof d&&(0,s.s)("followClicked",{name:d.name,isUnfollow:!h,vendorId:d.vendorId,vendorName:d.vendorName,targetUserId:d.targetUserId,followSource:d.followSource,vendorIdentifier:d.vendorIdentifier})):y()}}))}},96170:function(e){e.exports={highlight:"NtRr9q","highlight__image-container":"f01oUn",highlight__image:"pko8H0",highlight__title:"_8BDLgP"}},41131:function(e){e.exports={highlights:"KbzUxG",highlights__next:"ovEDQp",highlights__prev:"rwxuI2","highlights__next-button":"_8YUUri","highlights__prev-button":"TJvhjP"}}}]);